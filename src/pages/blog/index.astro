---
import { getCollection } from 'astro:content';
import AppWrapper from '../../building-blocks/AppWrapper.astro';
import BlogCardWithImage from '../../components/BlogCardWithImage.astro';
import SectionHeading from '../../components/SectionHeading.astro';
import { siteConfig } from '../../config/site';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf(),
);
---

<AppWrapper title={`Blog - ${siteConfig.title}`} description={siteConfig.description}>
	<!-- Hero Section -->
	<section class="text-center max-w-4xl mx-auto">
		<h1 class="mb-4">Blog</h1>
		<p class="text-xl mx-auto max-w-xl pt-6">
			Real insights from production code, proven solutions, and lessons learned from building at scale.
		</p>
	</section>

	<!-- Blog Posts Section -->
	<section>
		<SectionHeading>All articles</SectionHeading>
		<div class="grid gap-8 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 md:px-12">
			{posts.map((post) => (
				<BlogCardWithImage 
					slug={post.id} 
					date={post.data.pubDate}
					imageUrl={post.data.heroImage.src}
				>
					<div slot="title">{post.data.title}</div>
					<Fragment slot="description">{post.data.description}</Fragment>
				</BlogCardWithImage>
			))}
		</div>
	</section>
</AppWrapper>
